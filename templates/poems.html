<!DOCTYPE html>
<html>
<head>
	<title>Poem Control Panel</title>
</head>
<body>
	<h1>📜 Poem Manager</h1>

	<!-- Add a new poem -->
	<form action="/poem_override" method="POST">>
		<textarea name="poem_text" rows="4" cols="60" placeholder="Write a new poem..." required></textarea><br>
		<input name="poem_author" placeholder="Author (optional)"><br>
		<button type="submit">➕ Add Poem</button>
	</form>

	<hr>

	<!-- Send a temporary override -->
	<h2>💌 Send a Message</h2>
	<form method="POST" action="{{ url_for('poem_override') }}">
		<input name="override_msg" placeholder="This message will replace poems temporarily" size="60">
		<button type="submit">📤 Send Message</button>
	</form>

	<p><strong>Current Override:</strong> {{ override }}</p>

	<hr>

	<!-- Clear Override -->
	<form id="clear-form" method="POST" action="/clear_override" onsubmit="return clearOverride();">
		<button type="submit">🧹Clear override</button>
	</form>
	<p id="confirmation-msg" style="color: green; display: none;">✅ Override cleared.</p>

	<script>
	function clearOverride() {
		fetch("/clear_override", {
			method: "POST"
		})
		.then(response => response.json())
		.then(data => {
			if (data.status === "success") {
				const msg = document.getElementById("confirmation-msg");
				msg.style.display = "block";
				setTimeout(() => {
					msg.style.display = "none";
				}, 3000); // Hide after 3 seconds
			}
		});
		return false; // Prevent full page reload
	}
	</script>
	<!-- List poems -->
	<h2>📝 Current Poems</h2>
	<ul>
		{% for poem in poems %}
			<li>
				"{{ poem.text }}"
				{% if poem.author %}— <i>{{ poem.author }}</i>{% endif %}
				{% if poem.favorite %} ⭐{% endif %}
			</li>
		{% endfor %}
	</ul>
</body>
</html>
